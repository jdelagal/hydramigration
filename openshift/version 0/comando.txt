kompose --provider openshift --file docker-compose.yml convert

  --id test1 \
  --secret consent-secret \
  --name "Consent App Client" \
  --grant-types client_credentials \
  --response-types token \
  --allowed-scopes hydra.consent 

  hydra connect --url https://localhost:4444 --id admin --secret admin-password

  hydra clients create --skip-tls-verify \
  --id testing_sin_root \
  --secret consent-secret \
  --name "Consent App Client" \
  --grant-types client_credentials \
  --response-types token \
  --allowed-scopes hydra.consent 
  

curl -s -k -X POST \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d grant_type=client_credentials \
  -d scope=hydra.consent \
  -u 'testing:consent-secret' \
  https://localhost:4444/oauth2/token 

curl -k -s \
     --request POST \
     --header "Content-Type: application/x-www-form-urlencoded" \
     --header "Authorization: Bearer 3mCBGaA1f_FlKoq6nIzUgt4htKQbZplhBsmc76j_7_M.i6SWzUUOoSpuvPCVeyxMJQpuGMERsDyx_N2i_W8rQ94" \
     -d "token=Ltz8CQ3n2Fcp7RT0MCwDaPZ-9cUPcjMmi6o5l8YuFZY.GmEpUbR7PuHGCjMfBtECzZE4hn_7bAu6H_r23-anz5M" \
https://localhost:4444/oauth2/introspect

hydra clients create --skip-tls-verify \
 --id some-consumer \
 --secret consumer-secret \
 -g authorization_code,refresh_token,client_credentials \
 -r token,code,id_token \
 --allowed-scopes openid,offline,hydra.clients \
 --callbacks http://localhost:9010/callback


 hydra clients create --skip-tls-verify \
 --id some-consumer \
 --secret consumer-secret \
 -g authorization_code,refresh_token,client_credentials \
 -r token,code,id_token \
 --allowed-scopes openid,offline,hydra.clients \
 --callbacks http://localhost:9010/callback



-----DEMO  IÃ‘AKI ------------

curl -s -k -X POST \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d grant_type=client_credentials \
  -d client_id=XXXee58011c-b781-41a7-8238-938f7f2939a3 \
  -d scope=read \
  -u 'ee58011c-b781-41a7-8238-938f7f2939a3:dW7uO8jB5eR7hT6bW5wP7uG0hM7qB3iO3fX8hN6vS5cO0eN5hR' \
  http://microservice:8080/oauth/sfsf


curl -k -s \
     --request GET \
     --header "Content-Type: application/x-www-form-urlencoded" \
     --header "Authorization: Bearer sdssdsd" \
http://microservice:8080/private


curl -k -s \
     --request GET \
     --header "Content-Type: application/x-www-form-urlencoded" \
     --header "Authorization: Bearer 978112bc-1edb-481d-9c32-26afe9686f78" \
http://microservice:8080/admin

-------------CURL DE GESTION DE PORTAL APICONNECT ---------------------

curl -X GET \
    -u userid:pw \
    https://<mgmt-cluster-ip>/v1/portal/orgs/{orgID}/apps


curl -X GET \
    -u jose.delagala@ust-global.com:!n0r1t5@C \
    https://apim/apim/v1/portal/orgs/factoriaustglobal/apps



curl -k -i -H "X-IBM-APIManagement-Context: provider_organization_name.catalog_short_name" -X GET https://management_service_address/v1/portal/products

curl -k -i -H "X-IBM-APIManagement-Context: factoriaustglobal.sb" -X GET https://apim/apim/v1/portal/products

GET https://apim/apim/v1/portal/config?originURL=https://ibmportal/factoriaustglobal/sb


-----OK------------
curl -k -v -H "X-IBM-APIManagement-Context: factoriaustglobal.sb" -H "Content-Type: application/json" -X POST -d \
'{"username":"sdsd@gmail.com","password":"!n0r1t5@C","firstName":"sdsds","lastName":"last_name","organization":"factoriaustglobal"}' \
https://apim/v1/portal/users/register


curl -k -v -H "X-IBM-APIManagement-Context: factoriaustglobal.sb" -H "Content-Type: application/json" -X GET -d \
'{"username":"jdelagal@gmail.com","password":"!n0r1t5@C","organization":"factoriaustglobal"}' \
https://apim/v1/portal/users/register


curl -k -v -H "X-IBM-APIManagement-Context: factoriaustglobal.sb" -H "Content-Type: application/json" -X GET \
    -u jdelagal@gmail.com:\"!n0r1t5@C\" \
    https://apim/v1/portal/orgs/factoriaustglobal/apps


--------DOCS----------------------------------------
curl -k -v  -H "Content-Type: application/json" -H -X GET \
    https://apim/v1/portal/config?originURL=https://ibmportal/factoriaustglobal/sb


curl -k -v  -H "Content-Type: application/json" \
-H "Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOiFuMHIxdDVAQw==" \
-H "X-IBM-APIManagement-Context: factoriaustglobal.sb" \
-X GET  https://apim/v1/portal/orgs

        curl -k -v -H "Content-Type: application/json" \
                                 -H "Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOlwhbjByMXQ1QEM=" \
                                 -H "X-IBM-APIManagement-Context: factoriaustglobal.sb" \
                                 -X GET  https://apim/v1/portal/orgs

curl -k -v  -H "Content-Type: application/json" \
-H "Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOiFuMHIxdDVAQw==" \
-H "X-IBM-APIManagement-Context: factoriaustglobal.sb" \
-X GET  https://apim/v1/portal/orgs/5ae9cdbce4b002e84d9e0d25/apps

curl -k -v -X PUT \
-H "Content-Type: application/json" \
-H "Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOiFuMHIxdDVAQw==" \
-H "X-IBM-APIManagement-Context: factoriaustglobal.sb" \
-d '{"clientSecret":true}' \
 https://apim/v1/portal/orgs/5ae9cdbce4b002e84d9e0d25/apps/5b0bdfaae4b002e84d9e811e/credentials/reset

 curl -k -v -X PUT \
-H "Content-Type: application/json" \
-H "Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOiFuMHIxdDVAQw==" \
-H "X-IBM-APIManagement-Context: factoriaustglobal.sb" \
-d @clientSecret.json \
 https://apim/v1/portal/orgs/5ae9cdbce4b002e84d9e0d25/apps/5b0bdfaae4b002e84d9e811e/credentials/reset

 groovy addConsumers.groovy jdelagal@gmail.com \!n0r1t5@C apim factoriaustglobal.sb myorganization
 
 groovy saveCredentials.groovy jdelagal@gmail.com \!n0r1t5@C apim factoriaustglobal.sb myorganization
 groovy addCredentials.groovy hydra-hydraserver.192.168.99.104.nip.io
 
 groovy getOrgs.groovy jdelagal@gmail.com \!n0r1t5@C apim factoriaustglobal.sb myorganization

 docker run -d -u root -it --rm --name daimongroovyrediscli -p 6379:6379 jdelagal/groovy:version3 redis-server

        sh curl -k -v  -H "Content-Type: application/json" \
                                -H "Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOiFuMHIxdDVAQw==" \
                                -H "X-IBM-APIManagement-Context: factoriaustglobal.sb" \
                                -X GET  https://apim/v1/portal/orgs


curl -k -v -H 'Content-Type: application/json' -H 'Authorization:Basic amRlbGFnYWxAZ21haWwuY29tOiFuMHIxdDVAQw==' -H 'X-IBM-APIManagement-Context: factoriaustglobal.sb' -X GET  https://apim/v1/portal/orgs

new File('test1.sh').write curl -k -v
redis-server --service-install redis.windows.conf
---------------------------Create client hydra ---------------------------


curl -s -k -X POST \
        -H "Content-Type: application/x-www-form-urlencoded" \
        -H "Authorization: Basic YWRtaW46YWRtaW4tcGFzc3dvcmQ=" \
        -d grant_type=client_credentials \
        -d scope=hydra \
        -u 'admin:demo-password' \
        https://hydra-hydraserver.192.168.99.104.nip.io/oauth2/token 
---debugg---
        curl -s -k -X POST \
        -H 'Content-Type: application/x-www-form-urlencoded' \
        -H 'Authorization: Basic YWRtaW46YWRtaW4tcGFzc3dvcmQ=' \
        -d 'grant_type=client_credentials' \
        -d 'scope=hydra' \
        -u 'admin:demo-password' \
        https://hydra-hydraserver.192.168.99.104.nip.io/oauth2/token

curl -s -k -X GET \
    -H "Content-Type: application/json" \
        -H "Authorization:bearer vVIRMzGHUaJFV1KEMg-YoR95sRYglXM6CJUIBmVhFt0.Nvj3Nif2iE1KJEigXNnA10Sp8nyewGNahdjb0vAll6k" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients"

curl -s -k -X GET \
    -H "Content-Type: application/json" \
        -H "Authorization:bearer ochmIUvCQfSgRBgHkQIuKeYEp4OjItV-zcaAmwool7w.I-mnmtZQO6d3m6Fh9LXtX4y7XPrjMwmE5z1s0tDuWCg" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients/accesoexterno"

curl -s -k \
  -X POST \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer ZK8NhSlAxX973z4Js-WkcR9QLzoWiPM5KXM0YW59sdg.wHloKbUYgIJDykN0zvS3ns6Abg0GgPUr2Dt98NVi1vI" \
  -d '{"id":"clientecreadodesdefuera","client_secret":"clientecreadodesdefuera"}, "grant_type":"client_credentials" ' \
  "https://hydra-hydraserver.192.168.99.104.nip.io/clients"


  curl -s -k \
  -X PUT \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer ochmIUvCQfSgRBgHkQIuKeYEp4OjItV-zcaAmwool7w.I-mnmtZQO6d3m6Fh9LXtX4y7XPrjMwmE5z1s0tDuWCg" \
  -d '{"client_name":"clientecreadodesdefuera", "id":"clientecreadodesdefuera","client_secret":"otrosecreto", "grant_type":"client_credentials"}' \
  "https://hydra-hydraserver.192.168.99.104.nip.io/clients/clientecreadodesdefuera"

  curl -s -k \
  -X POST \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer ZK8NhSlAxX973z4Js-WkcR9QLzoWiPM5KXM0YW59sdg.wHloKbUYgIJDykN0zvS3ns6Abg0GgPUr2Dt98NVi1vI" \
  -d '{"id":"otramasdesdefuera","client_secret":"otramasdesdefuera"}, "grant_type":"client_credentials" ' \
  "https://hydra-hydraserver.192.168.99.104.nip.io/clients"



    curl -s -k \
  -X DELETE \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer ZK8NhSlAxX973z4Js-WkcR9QLzoWiPM5KXM0YW59sdg.wHloKbUYgIJDykN0zvS3ns6Abg0GgPUr2Dt98NVi1vI" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients/otramasdesdefuera"


  curl -s -k -X GET \
    -H "Content-Type: application/json" \
        -H "Authorization:bearer ZK8NhSlAxX973z4Js-WkcR9QLzoWiPM5KXM0YW59sdg.wHloKbUYgIJDykN0zvS3ns6Abg0GgPUr2Dt98NVi1vI" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients"

  curl -s -k \
  -X POST \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer ZK8NhSlAxX973z4Js-WkcR9QLzoWiPM5KXM0YW59sdg.wHloKbUYgIJDykN0zvS3ns6Abg0GgPUr2Dt98NVi1vI" \
  -d '{"id":"otramasdesdefuera","client_secret":"otramasdesdefuera"}, "grant_type":"client_credentials" ' \
  "https://hydra-hydraserver.192.168.99.104.nip.io/clients"

  curl -s -k -X GET \
    -H "Content-Type: application/json" \
        -H "Authorization:bearer ZK8NhSlAxX973z4Js-WkcR9QLzoWiPM5KXM0YW59sdg.wHloKbUYgIJDykN0zvS3ns6Abg0GgPUr2Dt98NVi1vI" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients/otramasdesdefuera"


  curl -s -k -X POST \
      -H "Content-Type: application/x-www-form-urlencoded" \
      -H "Authorization: Basic YWNjZXNvZXh0ZXJubzphY2Nlc29leHRlcm5v" \
      -d grant_type=client_credentials \
      -d scope=hydra.accesoexterno \
     https://hydra-hydraserver.192.168.99.104.nip.io/oauth2/token

  curl -s -k -X POST \
      -H "Content-Type: application/x-www-form-urlencoded" \
      -d grant_type=client_credentials \
      -d scope=hydra.accesoexterno \
      -u accesoexterno:accesoexterno \
     https://hydra-hydraserver.192.168.99.104.nip.io/oauth2/token

        curl -s -k -X POST \
        -H 'Content-Type: application/x-www-form-urlencoded' \
        -H 'Authorization: Basic YWRtaW46YWRtaW4tcGFzc3dvcmQ=' \
        -d 'grant_type=client_credentials' \
        -d 'scope=hydra' \
        -u 'admin:demo-password' \
        https://hydra-hydraserver.192.168.99.104.nip.io/oauth2/token

  curl -s -k \
  -X POST \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer 37joXh-BWSwRGjppB3a2qhMjNFApYW__6L0cNMqCBpY.Qe3sPm7AtJKb7Q2pF_i2EbfL9z19zpL_tgDUV81O9l8" \
  -d '{"id":"incidencia","client_secret":"incidencia","scope":"hydra.incidencia"}' \
  -d grant_type:client_credentials \
  "https://hydra-hydraserver.192.168.99.104.nip.io/clients"

    curl -s -k \
  -X DELETE \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer 37joXh-BWSwRGjppB3a2qhMjNFApYW__6L0cNMqCBpY.Qe3sPm7AtJKb7Q2pF_i2EbfL9z19zpL_tgDUV81O9l8" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients/incidencia"

  curl -s -k \
  -X PUT \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer 4-pAS-oeb4fY0vzIDytRD-gSUMHgxHffbsTH7VNRBVc.jpqctPpmLuEkToVwHkQkAfr2FDZneio9pDcaq-S7YDc" \
  -d '{"client_name":"incidencia", "id":"incidencia","client_secret":"incidencia", "grant_type":"client_credentials"}' \
  "https://hydra-hydraserver.192.168.99.104.nip.io/clients/incidencia"

  curl -s -k -X POST \
        -H 'Content-Type: application/x-www-form-urlencoded' \
        -d 'grant_type=client_credentials' \
        -d 'scope=hydra.incidencia' \
        -u "incidencia:incidencia" \
        https://hydra-hydraserver.192.168.99.104.nip.io/oauth2/token

https://github.com/cheddarwhizzy/hydra-poc

8c7840cb-0e88-4b09-820f-a18715e463d3
oE0pC8xK1aP0hB5bA4vC5tO0yM5aX8nJ5cY2aE0oV0iQ3wB7eO
 hydra-hydraserver.192.168.99.104.nip.io



curl -s -k \
  -X DELETE \
  -H "Content-Type: application/json" \
        -H "Authorization:bearer uo5Izec_zZms-evRRm844DUu8wrXpZfy8Onvv6khmWQ.kxHu6I8H0_cJhLj97K9k_A4yQAfyPE6wCruZI9KzSvo" \
    'https://hydra-hydraserver.192.168.99.104.nip.io/clients/8c7840cb-0e88-4b09-820f-a18715e463d3'

curl -s -k -X GET \
    -H 'Content-Type: application/x-www-form-urlencoded' \
    -H "Authorization:bearer uo5Izec_zZms-evRRm844DUu8wrXpZfy8Onvv6khmWQ.kxHu6I8H0_cJhLj97K9k_A4yQAfyPE6wCruZI9KzSvo" \
    "https://hydra-hydraserver.192.168.99.104.nip.io/clients/8c7840cb-0e88-4b09-820f-a18715e463d3"